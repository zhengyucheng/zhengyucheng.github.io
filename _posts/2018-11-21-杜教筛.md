---
layout:     post
title:      "杜教筛"
subtitle:   "YEs"
date:       2018-11-21
author:     "JU"
header-img: "img/post-bg-2015.jpg"
mathjax:    true
catalog:    true
tags:
    - 数论
---


##Luogu3768
$$
\sum_{i=1}^{n}\sum_{j=1}^{n}ij\gcd(i,j)
$$


$$
\sum_{i=1}^{n}i\sum_{j=1}^{n}j\sum_{d|\gcd(i,j)}\phi(d)
$$


$$
ans=\sum_{d=1}^{n}\phi(d)d^2\lfloor\frac{(n)(n+1)}{2}\rfloor^2
$$


$$
h(n)=n^3,f(n)=\phi(n)n^2,g(n)=n^2
$$


$$
S(n)=\sum_{i=1}^{n}f(i),G(n)=\sum_{i=1}^{n}g(i)=\frac{n(n+1)(2n+1)}{6},H(n)=\sum_{i=1}^{n}h(i)=\frac{n^2(n+1)^2}{4}
$$


$$
\sum_{i=1}^{n}h(i)=\sum_{i=1}^{n}\sum_{d|i}g(d)f(\frac{i}{d})
$$


$$
=\sum_{d=1}^{n}g(d)\sum_{i=1}^{n/d}f(i)
$$


$$
=\sum_{d=1}^{n}g(d)S(\lfloor\frac{n}{d}\rfloor)
$$


$$
H(n)=g(1)S(n)+\sum_{d=2}^{n}g(d)S(\lfloor\frac{n}{d}\rfloor)
$$


$$
S(n)=H(n)-\sum_{d=2}^{n}g(d)S(\lfloor\frac{n}{d}\rfloor)
$$

---
layout:     post
title:      "高斯消元"
subtitle:   "这是什么“玩意”"
date:       2018-05-13
author:     "JU"
header-img: "img/post-bg-2015.jpg"
mathjax:    false
catalog:    true
tags:
    - 数论
---


## BZOJ1013


    #include <bits/stdc++.h>
    #define sc(p) scanf("%d",&p)
    #define sc2(p1,p2) scanf("%d%d",&p1,&p2)
    #define sc3(p1,p2,p3) scanf("%d%d%d",&p1,&p2,&p3)
    #define pr(p) printf("%d\n",p)
    using namespace std;
    const int N=20;
    const int oo=2139062143;   //0x7f
    const double eps=1e-6;
    double a[N][N],ans[N];
    int n,m;
    int gauss()
    {
        if (m<n) return 0;
        for (int i=1; i<=n; i++)
        {
            int k=i;
            for (int j=i+1; j<=m; j++) if (abs(a[k][i])<abs(a[j][i])) k=j;
            for (int j=1; j<=n+1; j++) swap(a[i][j],a[k][j]);
            if (abs(a[i][i])<eps) return 0;
            for (int j=1; j<=m; j++) if (j!=i)
            {
                double p=a[j][i]/a[i][i];
                for (int k=1; k<=n+1; k++) a[j][k]-=a[i][k]*p;
            }
        }
        for (int i=n+1; i<=m; i++) if (abs(a[i][n+1])>eps) return 0;
        for (int i=1; i<=n; i++) ans[i]=a[i][n+1]/a[i][i];
        return 1;
    }
    double sb[N][N];
    int main()
    {
        //freopen(".in","r",stdin);
        //freopen(".out","w",stdout);
        sc(n); m=n;
        for (int i=1; i<=n+1; i++)
        for (int j=1; j<=n; j++) cin>>sb[i][j];

        for (int i=1; i<=n; i++)
        {
            double sum=0;
            for (int j=1; j<=n; j++)
            {
                double s1=sb[i][j],s2=sb[i+1][j];
                a[i][j]=2*(s1-s2),sum+=s1*s1-s2*s2;
            }	
            a[i][n+1]=sum;
        }
        gauss ();
        for (int i=1; i<=n; i++)
        printf ("%.3lf ",ans[i]);
        return 0;
    }

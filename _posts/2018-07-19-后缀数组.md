---
layout:     post
title:      "后缀数组"
subtitle:   "莫名其妙"
date:       2018-07-19
author:     "JU"
header-img: "img/post-bg-2015.jpg"
mathjax:    false
catalog:    true
tags:
    - 字符串
---

## POJ2774
    #include <iostream>
    #include <cstdio>
    #include <cstdlib>
    #include <string>
    #include <cstring>
    #define pr(p) printf("%d\n",p)
    const int oo=2147483640;
    const int N=110000*2;
    const int mod=1000000007;
    using namespace std;
    int tmp1[N],tmp2[N],cnt[N],SA[N],rank[N],height[N];
    char s[N],s1[N]; 
    int main()
    {
	    int n1,n;
	    scanf ("%s",s+1);
	    n1=n=strlen (s+1);
	    s[n+1]='#';
	    scanf ("%s",s+n+2);
	    n=strlen (s+n+2)+n+1;
        int *x=tmp1,*y=tmp2,m=0;
        for (int i=1; i<=n; i++) x[i]=s[i],m=max (m,x[i]);
        memset (cnt,0,sizeof (cnt));
        for (int i=1; i<=n; i++) cnt[x[i]]++;
        for (int i=1; i<=m; i++) cnt[i]+=cnt[i-1];
        for (int i=n; i>=1; i--) SA[cnt[x[i]]--]=i;
        for (int L=1; L<=n; L<<=1)
        {
           	int p=0;
           	for (int i=n-L+1; i<=n; i++) y[++p]=i;
           	for (int i=1; i<=n; i++) if (SA[i]>L) y[++p]=SA[i]-L;
           	
           	memset (cnt,0,sizeof (cnt));
           	for (int i=1; i<=n; i++) cnt[x[y[i]]]++;
           	for (int i=1; i<=m; i++) cnt[i]+=cnt[i-1];
           	for (int i=n; i>=1; i--) SA[cnt[x[y[i]]]--]=y[i];
           	
           	swap (x,y);
           	x[SA[1]]=m=1;
           	for (int i=2; i<=n; i++)
           	if (y[SA[i]]==y[SA[i-1]]&&y[SA[i]+L]==y[SA[i-1]+L]) x[SA[i]]=m;
           	else x[SA[i]]=++m;
           	
           	if (m==n) break;
        }
        for (int i=1; i<=n; i++) rank[SA[i]]=i; 
        for (int i=1,k=0; i<=n; i++)
        {
        	if (k>0) k--;
        	if (rank[i]>0) while (s[i+k]==s[SA[rank[i]-1]+k]) k++;
        	height[rank[i]]=k;
        }
        int ans=-oo;
        for (int i=2; i<=n; i++)
        {
        	int ma=max (SA[i-1],SA[i]);
        	int mi=min (SA[i-1],SA[i]);
        	if (ma>n1&&mi<=n1)
            ans=max (ans,height[i]);
	    }
 	    pr(ans);
    	
	    return 0;
    }
